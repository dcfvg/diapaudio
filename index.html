<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>diapaudio</title>
    <link rel="stylesheet" href="style.css" />
    <!-- zip.js for ZIP file extraction -->
    <script src="zip.min.js"></script>
    <script src="i18n.js"></script>
    <script src="timestamp-utils.js" defer></script>
    <script src="app.js" defer></script>
  </head>
  <body>
    <div class="app">
      <main class="app__main">
        <section class="viewer">
          <div class="dropzone" id="dropzone">
            <div class="dropzone__content">
              <div class="dropzone__language-selector">
                <label for="language-select" class="language-selector__label">
                  <!-- <span data-i18n="languageLabel">Language</span> -->
                  <select id="language-select" class="language-selector__select">
                    <option value="en">🇬🇧 English</option>
                    <option value="fr">🇫🇷 Français</option>
                    <option value="es">🇪🇸 Español</option>
                  </select>
                </label>
              </div>
              <div class="dropzone__hero">
                <h1 class="dropzone__title" data-i18n="appTitle">diapaudio 🛝</h1>
                <p class="dropzone__lead" data-i18n="tagline">🎧 Playback photos synced with recordings of that day.</p>
              </div>


              <div class="dropzone__assist" aria-label="How to prepare your folder">
                <ol class="dropzone__steps">
                  <li class="dropzone__step">
                    <span class="dropzone__step-icon" aria-hidden="true">📁</span>
                    <div>
                      <h3 class="dropzone__step-title" data-i18n="step1Title">Collect your files</h3>
                      <p class="dropzone__step-text" data-i18n="step1Text" data-i18n-html>Place audio recordings and the matching photos in <strong>one folder</strong>.</p>
                    </div>
                  </li>
                  <li class="dropzone__step">
                    <span class="dropzone__step-icon" aria-hidden="true">⏱️</span>
                    <div>
                      <h3 class="dropzone__step-title" data-i18n="step2Title">Use timestamps</h3>
                      <p class="dropzone__step-text" data-i18n="step2Text" data-i18n-html>Name each file with its capture time, for example <code>2025-01-01_08-00-00.jpg</code> <br/>(or make sure they contain metadata)</p>
                    </div>
                  </li>
                  <li class="dropzone__step">
                    <span class="dropzone__step-icon" aria-hidden="true">🚀</span>
                    <div>
                      <h3 class="dropzone__step-title" data-i18n="step3Title">Drop the folder or ZIP</h3>
                      <p class="dropzone__step-text" data-i18n="step3Text" data-i18n-html>Drag it here or browse for it below to replay the day.</p>
                    </div>
                  </li>
                </ol>
              </div>

              <div class="dropzone__cta" role="group" aria-label="Start syncing">
                <p class="dropzone__cta-text" id="dropzone-message" data-i18n="dropMessage">Drop your prepared folder or ZIP file anywhere in this area.</p>
                <div class="dropzone__buttons">
                  <button type="button" class="dropzone__browse" id="browse-folder" data-i18n="buttonFolder">📂 Choose a folder</button>
                  <button type="button" class="dropzone__browse" id="browse-zip" data-i18n="buttonZip">📦 Choose a ZIP file</button>
                  <button type="button" class="dropzone__browse" id="browse-files" data-i18n="buttonFiles">🎬 Choose files</button>
                </div>
              </div>

              <div class="dropzone__body">
                <p class="dropzone__note" data-i18n="notePrivacy">🔒 Nothing leaves your computer — no uploads, no servers, just your session.</p>
                <p class="dropzone__note" data-i18n="noteTip">💡 Tip: keeping your recorder, camera, and phone on the same time makes syncing effortless.</p>
                <p class="dropzone__note" data-i18n="noteReadme" data-i18n-html>📚 For detailed instructions and source code, see the <a href="https://github.com/dcfvg/diapaudio" target="_blank" rel="noopener noreferrer">README</a>.</p>
              </div>

              <div class="dropzone__loader hidden" id="dropzone-loader">
                <div class="loader-spinner"></div>
                <p id="loader-status" data-i18n="loadingFiles">Loading files...</p>
                <div class="loader-progress">
                  <div class="loader-progress-bar" id="loader-progress-bar"></div>
                </div>
                <p class="loader-details" id="loader-details"></p>
              </div>
            </div>
            <input type="file" webkitdirectory directory multiple id="folder-input" hidden />
            <input type="file" accept=".zip,application/zip,application/x-zip-compressed" id="zip-input" hidden />
            <input type="file" accept="audio/*,image/*,.mp3,.wav,.ogg,.m4a,.aac,.flac,.jpg,.jpeg,.png,.gif" multiple id="files-input" hidden />
          </div>
          <div class="viewer__content hidden" id="viewer-content">
            <div class="viewer__slideshow">
              <div class="slideshow__container" id="slideshow-container">
                <!-- Images will be dynamically inserted here -->
              </div>
              <div class="slideshow__preview hidden" id="slideshow-preview"></div>
              <div class="viewer__clock" id="viewer-clock">
                <svg class="clock-svg clock-analog" id="clock-analog" viewBox="0 0 100 100">
                  <circle class="clock-face" cx="50" cy="50" r="48" />
                  <!-- Hour ticks for all 12 hours -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(0 50 50)" /><!-- 12 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(30 50 50)" /><!-- 1 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(60 50 50)" /><!-- 2 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(90 50 50)" /><!-- 3 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(120 50 50)" /><!-- 4 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(150 50 50)" /><!-- 5 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(180 50 50)" /><!-- 6 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(210 50 50)" /><!-- 7 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(240 50 50)" /><!-- 8 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(270 50 50)" /><!-- 9 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(300 50 50)" /><!-- 10 -->
                  <line class="clock-tick" x1="50" y1="2" x2="50" y2="8" transform="rotate(330 50 50)" /><!-- 11 -->
                  <line class="clock-hour-hand" id="clock-hour-hand" x1="50" y1="50" x2="50" y2="30" />
                  <line class="clock-minute-hand" id="clock-minute-hand" x1="50" y1="50" x2="50" y2="18" />
                  <line class="clock-second-hand" id="clock-second-hand" x1="50" y1="50" x2="50" y2="12" />
                  <circle class="clock-center" cx="50" cy="50" r="3" />
                </svg>
                <div class="clock-digital hidden" id="clock-digital">
                  <div class="clock-time" id="clock-time">00:00:00</div>
                </div>
                <div class="clock-date" id="clock-date">01/01/2025</div>
              </div>
              <div class="viewer__meta">
              </div>
              <div class="viewer__hud" id="viewer-hud">
                <div class="timeline hidden" id="timeline">
                  <div class="timeline__toolbar">
                    <button class="control-button control-button--icon" id="play-toggle" disabled data-i18n-aria="play" aria-label="Play">
                      <span class="control-button__icon" aria-hidden="true">▶</span>
                      <span class="visually-hidden control-button__sr-label" data-i18n="play">Play</span>
                    </button>
                    <div class="timeline__scrubber">
                      <div class="timeline__main">
                        <div class="timeline__gradient" id="timeline-gradient"></div>
                        <div class="timeline__gridlines" id="timeline-gridlines"></div>
                        <div class="timeline__axis" id="timeline-axis"></div>
                        <div class="timeline__tracks" id="timeline-tracks"></div>
                        <div class="timeline__images" id="timeline-images"></div>
                        <div class="timeline__cursor" id="timeline-cursor"></div>
                        <div class="timeline__seeker" id="timeline-seeker"></div>
                        <div class="timeline__hover-preview hidden" id="timeline-hover-preview">
                          <div class="timeline__hover-preview-track" id="timeline-hover-preview-track"></div>
                          <div class="timeline__hover-preview-images" id="timeline-hover-preview-images"></div>
                          <div class="timeline__hover-preview-time" id="timeline-hover-preview-time"></div>
                        </div>
                      </div>
                    </div>
                    <div class="timeline__inputs">
                      <div class="timeline__controls-row">
                        <label class="speed-control">
                          <span data-i18n="speed">Speed</span>
                          <select id="speed-select" class="speed-control__select">
                            <option value="0.5">0.5×</option>
                            <option value="0.75">0.75×</option>
                            <option value="1" selected>1×</option>
                            <option value="1.25">1.25×</option>
                            <option value="1.5">1.5×</option>
                            <option value="1.8">1.8×</option>
                            <option value="2">2×</option>
                            <option value="2.5">2.5×</option>
                            <option value="3">3×</option>
                          </select>
                        </label>
                        <label class="skip-silence-control">
                          <input type="checkbox" id="skip-silence-checkbox" checked />
                          <span data-i18n="skipSilence">Skip silence</span>
                        </label>
                        <button type="button" class="export-button" id="export-fcp-button" data-i18n-title="exportButton" title="Export Final Cut Pro XML">
                          <span class="export-button__icon">⬇️</span>
                          <span class="export-button__label">XML</span>
                        </button>
                      </div>
                      <div class="timeline__controls-row">
                        <label class="delay-control">
                          <span data-i18n="delay">Delay</span>
                          <div class="delay-control__inputs">
                            <input type="text" id="delay-field" value="0:00" inputmode="numeric" autocomplete="off" placeholder="0:00" />
                          </div>
                        </label>
                        <button type="button" class="export-button" id="export-zip-button" data-i18n-title="exportZipButton" title="Download ZIP">
                          <span class="export-button__icon">📦</span>
                          <span class="export-button__label">ZIP</span>
                        </button>
                      </div>
                    </div>
                  </div>
                  <div class="timeline__notices hidden" id="timeline-notices"></div>
                </div>
              </div>
              <!-- Timeline Notices Modal -->
              <div class="timeline-notices-modal hidden" id="timeline-notices-modal" role="alertdialog" aria-modal="true">
                <div class="timeline-notices-modal__content">
                  <button class="timeline-notices-modal__close" id="timeline-notices-modal-close" title="Close">&times;</button>
                  <div id="timeline-notices-modal-messages"></div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
      
      <!-- Global loader overlay -->
      <div class="global-loader hidden" id="global-loader">
        <div class="global-loader__content">
          <div class="loader-spinner"></div>
          <p id="global-loader-status" data-i18n="loadingFiles">Loading files...</p>
          <div class="loader-progress">
            <div class="loader-progress-bar" id="global-loader-progress-bar"></div>
          </div>
          <p class="loader-details" id="global-loader-details"></p>
        </div>
      </div>
    </div>
  </body>
</html>
